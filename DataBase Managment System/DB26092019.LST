SQL> set autocommit on;
SQL> desc books;
 Name                                                  Null?    Type
 ----------------------------------------------------- -------- ------------------------------------
 BOOK_NO                                               NOT NULL NUMBER(6)
 BOOK_NAME                                             NOT NULL VARCHAR2(30)
 AUTHOR_NAME                                                    VARCHAR2(30)
 COST                                                           NUMBER(7,2)
 CATEGORY                                                       CHAR(10)

SQL> desc member;
 Name                                                  Null?    Type
 ----------------------------------------------------- -------- ------------------------------------
 MEMBER_ID                                             NOT NULL NUMBER(5)
 MEMBER_NAME                                                    VARCHAR2(30)
 MEMBER_ADDRESS                                                 VARCHAR2(50)
 ACC_OPEN_DATE                                                  DATE
 MEMBERSHIP_TYPE                                                VARCHAR2(20)
 FEES_PAID                                                      NUMBER(4)
 MAX_BOOKS_ALLOWED                                              NUMBER(2)
 PENALTY_AMOUNT                                                 NUMBER(7,2)

SQL> desc issue;
 Name                                                  Null?    Type
 ----------------------------------------------------- -------- ------------------------------------
 LIB_ISSUE_ID                                          NOT NULL NUMBER(10)
 BOOK_NO                                                        NUMBER(6)
 MEMBER_ID                                                      NUMBER(5)
 ISSUE_DATE                                                     DATE
 RETURN_DATE                                                    DATE

SQL> select * from books;

  BOOK_NO BOOK_NAME                      AUTHOR_NAME                         COST CATEGORY          
--------- ------------------------------ ------------------------------ --------- ----------        
      101 LET US C                       DENIS RITCHIE                        450 SCIENCE           
      102 ORACLE COMPLETE REFERENCE      LONI                                 550 DATABASE          
      103 MASTERING SQL                  LONI                                 300 RDBMS             
      104 PL SQL-REF                     SCOTT URMAN                          750 DATABASE          

SQL> select * from member;

MEMBER_ID MEMBER_NAME                    MEMBER_ADDRESS                                             
--------- ------------------------------ --------------------------------------------------         
ACC_OPEN_ MEMBERSHIP_TYPE      FEES_PAID MAX_BOOKS_ALLOWED PENALTY_AMOUNT                           
--------- -------------------- --------- ----------------- --------------                           
        1 A                              SURAT                                                      
12-FEB-00 Lifetime                  1000                20            300                           
                                                                                                    
        2 B                              BHUJ                                                       
10-FEB-99 Annual                     300                30            500                           
                                                                                                    
        3 C                              UNJHA                                                      
20-MAR-99 Lifetime                   400                40            800                           
                                                                                                    

SQL> insert into member values(4,'LONI','SURAT','12-feb-99','Lifetime',2000,50,700);

1 row created.

Commit complete.
SQL> select * from books where AUTHOR_NAME = ANY(select MEMBER_NAME from member);

  BOOK_NO BOOK_NAME                      AUTHOR_NAME                         COST CATEGORY          
--------- ------------------------------ ------------------------------ --------- ----------        
      103 MASTERING SQL                  LONI                                 300 RDBMS             
      102 ORACLE COMPLETE REFERENCE      LONI                                 550 DATABASE          

SQL> ed
Wrote file afiedt.buf

  1* select distinct MEMBER_NAME from books where AUTHOR_NAME = ANY(select MEMBER_NAME from member)
SQL> /
select distinct MEMBER_NAME from books where AUTHOR_NAME = ANY(select MEMBER_NAME from member)
                *
ERROR at line 1:
ORA-00904: "MEMBER_NAME": invalid identifier 


SQL> ed
Wrote file afiedt.buf

  1* select distinct AUTHOR_NAME from books where AUTHOR_NAME = ANY(select MEMBER_NAME from member)
SQL> /

AUTHOR_NAME                                                                                         
------------------------------                                                                      
LONI                                                                                                

SQL> select MEMBER_NAME,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime' group by MEMBERSHIP_TYPE;
select MEMBER_NAME,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime' group by MEMBERSHIP_TYPE
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ed
Wrote file afiedt.buf

  1* select MEMBER_NAME,MEMBERSHIP_TYPE,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime' group by MEMBERSHIP_TYPE
SQL> /
select MEMBER_NAME,MEMBERSHIP_TYPE,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime' group by MEMBERSHIP_TYPE
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ed
Wrote file afiedt.buf

  1* select MEMBER_NAME,MEMBERSHIP_TYPE,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime'
SQL> /
select MEMBER_NAME,MEMBERSHIP_TYPE,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime'
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> ed
Wrote file afiedt.buf

  1* select MEMBER_NAME,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime'
SQL> /
select MEMBER_NAME,count(*) from member where MEMBERSHIP_TYPE = 'Lifetime'
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> ed
Wrote file afiedt.buf

  1* select MEMBER_NAME,count(*) from member group by MEMBERSHIP_TYPE
SQL> /
select MEMBER_NAME,count(*) from member group by MEMBERSHIP_TYPE
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> ed
Wrote file afiedt.buf

  1* select MEMBERSHIP_TYPE,count(*) from member group by MEMBERSHIP_TYPE
SQL> /

MEMBERSHIP_TYPE       COUNT(*)                                                                      
-------------------- ---------                                                                      
Annual                       1                                                                      
Lifetime                     3                                                                      

SQL> SELECT * FROM MEMBER;

MEMBER_ID MEMBER_NAME                    MEMBER_ADDRESS                                             
--------- ------------------------------ --------------------------------------------------         
ACC_OPEN_ MEMBERSHIP_TYPE      FEES_PAID MAX_BOOKS_ALLOWED PENALTY_AMOUNT                           
--------- -------------------- --------- ----------------- --------------                           
        1 A                              SURAT                                                      
12-FEB-00 Lifetime                  1000                20            300                           
                                                                                                    
        2 B                              BHUJ                                                       
10-FEB-99 Annual                     300                30            500                           
                                                                                                    
        3 C                              UNJHA                                                      
20-MAR-99 Lifetime                   400                40            800                           
                                                                                                    
        4 LONI                           SURAT                                                      
12-FEB-99 Lifetime                  2000                50            700                           
                                                                                                    

SQL> SELECT * FROM MEMBER
  2  .
SQL> ED
Wrote file afiedt.buf

  1* SELECT * FROM MEMBER
SQL> DESC ISSUE;
 Name                                                  Null?    Type
 ----------------------------------------------------- -------- ------------------------------------
 LIB_ISSUE_ID                                          NOT NULL NUMBER(10)
 BOOK_NO                                                        NUMBER(6)
 MEMBER_ID                                                      NUMBER(5)
 ISSUE_DATE                                                     DATE
 RETURN_DATE                                                    DATE

SQL> SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXIST(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime';
SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXIST(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime'
                                                 *
ERROR at line 1:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1* SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime'
SQL> /
SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime'
                                                                                                                               *
ERROR at line 1:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1* SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime')
SQL> /
SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime')
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1* SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime') GROUP BY MEMBER_ID
SQL> /

MEMBER_ID  COUNT(*)                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        2         4                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1* SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER WHERE MEMBERSHIP_TYPE = 'Lifetime' AND ISSUE.MEMBER_ID = MEMBER.MEMBER_ID) GROUP BY MEMBER_ID
SQL> /

MEMBER_ID  COUNT(*)                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        2         4                                                                                 
        3         2                                                                                 

SQL> SELECT * FROM MEMBER;

MEMBER_ID MEMBER_NAME                    MEMBER_ADDRESS                                             
--------- ------------------------------ --------------------------------------------------         
ACC_OPEN_ MEMBERSHIP_TYPE      FEES_PAID MAX_BOOKS_ALLOWED PENALTY_AMOUNT                           
--------- -------------------- --------- ----------------- --------------                           
        1 A                              SURAT                                                      
12-FEB-00 Lifetime                  1000                20            300                           
                                                                                                    
        2 B                              BHUJ                                                       
10-FEB-99 Annual                     300                30            500                           
                                                                                                    
        3 C                              UNJHA                                                      
20-MAR-99 Lifetime                   400                40            800                           
                                                                                                    
        4 LONI                           SURAT                                                      
12-FEB-99 Lifetime                  2000                50            700                           
                                                                                                    

SQL> ED
Wrote file afiedt.buf

  1* SELECT * FROM MEMBER
SQL> SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER W.
  2  ED
  3  ./
  4  .
SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE WHERE EXISTS(SELECT MEMBERSHIP_TYPE,COUNT(*) FROM MEMBER W.
  2  ED
  3* ./
SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime')
SQL> /
SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID
SQL> /

MEMBER_ID  COUNT(*)                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
                                                                                                               *
ERROR at line 2:
ORA-00934: group function is not allowed here 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID >= ALL(SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID >= ALL(SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
                                                                                                                              *
ERROR at line 2:
ORA-00933: SQL command not properly ended 


SQL> ED
Wrote file afiedt.buf

  1  SELECT COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT COUNT(*) FROM ISSUE 
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
SQL> ED
Wrote file afiedt.buf

  1  SELECT COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT COUNT(*) FROM ISSUE 
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT COUNT(*) FROM ISSUE 
                                                                                                               *
ERROR at line 2:
ORA-00934: group function is not allowed here 


SQL> ED
Wrote file afiedt.buf

  1  SELECT COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER 
  3  WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT COUNT(*) FROM ISSUE 
  4* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
  5  ;
WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') AND COUNT(*) >= ALL(SELECT COUNT(*) FROM ISSUE 
                                                                             *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> ED
Wrote file afiedt.buf

  1  SELECT COUNT(*) FROM ISSUE 
  2  WHERE EXISTS(SELECT * FROM MEMBER 
  3  WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') >= ALL(SELECT COUNT(*) FROM ISSUE 
  4* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
  5  ;
WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') >= ALL(SELECT COUNT(*) FROM ISSUE 
                                                                         *
ERROR at line 3:
ORA-00933: SQL command not properly ended 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) FROM ISSUE 
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID
  3  ;

MEMBER_ID  COUNT(*)                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE 
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
  3  /

MAX(MAXIMUM)                                                                                        
------------                                                                                        
           2                                                                                        

SQL> ASD
SP2-0042: unknown command "ASD" - rest of line ignored.
SQL> .
SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE 
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> SELECT * FROM BOOKS;

  BOOK_NO BOOK_NAME                      AUTHOR_NAME                         COST CATEGORY          
--------- ------------------------------ ------------------------------ --------- ----------        
      101 LET US C                       DENIS RITCHIE                        450 SCIENCE           
      102 ORACLE COMPLETE REFERENCE      LONI                                 550 DATABASE          
      103 MASTERING SQL                  LONI                                 300 RDBMS             
      104 PL SQL-REF                     SCOTT URMAN                          750 DATABASE          

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBERSHIP_TYPE,AVG(COST) FROM BOOKS
  2* GROUP BY MEMBERSHIP_TYPE
SQL> /
GROUP BY MEMBERSHIP_TYPE
         *
ERROR at line 2:
ORA-00904: "MEMBERSHIP_TYPE": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBERSHIP_TYPE,AVG(COST) FROM BOOKS NATURAL JOIN MEMBER
  2* GROUP BY MEMBERSHIP_TYPE
SQL> /

MEMBERSHIP_TYPE      AVG(COST)                                                                      
-------------------- ---------                                                                      
Annual                   512.5                                                                      
Lifetime                 512.5                                                                      

SQL> SELECT * FROM BOOKS
  2  WHERE COST>(
  3  .
SQL> SELECT MEMBERSHIP_TYPE,AVG(COST) FROM BOOKS NATURAL JOIN MEMBER
  2  GROUP BY MEMBERSHIP_TYPE
  3  .
SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM BOOKS B2
  2  WHERE COST >= (SELECT AVG(COST) FROM BOOKS B1 NATURAL JOIN MEMBER
  3* WHERE MEMBER.MEMBERSHIP_TYPE = B2.MEMBERSHIP_TYPE)
SQL> /
WHERE MEMBER.MEMBERSHIP_TYPE = B2.MEMBERSHIP_TYPE)
                               *
ERROR at line 3:
ORA-00904: "B2"."MEMBERSHIP_TYPE": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM BOOKS B2
  2  WHERE COST >= (SELECT AVG(COST) FROM BOOKS B1 NATURAL JOIN MEMBER
  3* WHERE MEMBER.MEMBERSHIP_TYPE = B2.MEMBERSHIP_TYPE)
SQL> DESC BOOKS;
 Name                                                  Null?    Type
 ----------------------------------------------------- -------- ------------------------------------
 BOOK_NO                                               NOT NULL NUMBER(6)
 BOOK_NAME                                             NOT NULL VARCHAR2(30)
 AUTHOR_NAME                                                    VARCHAR2(30)
 COST                                                           NUMBER(7,2)
 CATEGORY                                                       CHAR(10)

SQL> SELECT CATEGORY,AVG(COST) FROM BOOKS GROUP BY CATEGORY;

CATEGORY   AVG(COST)                                                                                
---------- ---------                                                                                
RDBMS            300                                                                                
DATABASE         650                                                                                
SCIENCE          450                                                                                

SQL> SELECT * FROM BOOKS B1
  2  WHERE COST >= (SELECT AVG(COST) FROM BOOKS B2 WHERE B1.CATEGORY = B2.CATEGORY);

  BOOK_NO BOOK_NAME                      AUTHOR_NAME                         COST CATEGORY          
--------- ------------------------------ ------------------------------ --------- ----------        
      101 LET US C                       DENIS RITCHIE                        450 SCIENCE           
      103 MASTERING SQL                  LONI                                 300 RDBMS             
      104 PL SQL-REF                     SCOTT URMAN                          750 DATABASE          

SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM BOOKS B1
  2* WHERE COST > (SELECT AVG(COST) FROM BOOKS B2 WHERE B1.CATEGORY = B2.CATEGORY)
SQL> /

  BOOK_NO BOOK_NAME                      AUTHOR_NAME                         COST CATEGORY          
--------- ------------------------------ ------------------------------ --------- ----------        
      104 PL SQL-REF                     SCOTT URMAN                          750 DATABASE          

SQL> SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE=
  3  .
SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME'))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME'))
                                                                                                          *
ERROR at line 2:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME')))
SQL> /
WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                              *
ERROR at line 2:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME') GROUP BY MEMBER_ID))
SQL> /

MEMBER_ID MEMBER_NAME                    MEMBER_ADDRESS                                             
--------- ------------------------------ --------------------------------------------------         
ACC_OPEN_ MEMBERSHIP_TYPE      FEES_PAID MAX_BOOKS_ALLOWED PENALTY_AMOUNT                           
--------- -------------------- --------- ----------------- --------------                           
        1 A                              SURAT                                                      
12-FEB-00 Lifetime                  1000                20            300                           
                                                                                                    
        2 B                              BHUJ                                                       
10-FEB-99 Annual                     300                30            500                           
                                                                                                    
        3 C                              UNJHA                                                      
20-MAR-99 Lifetime                   400                40            800                           
                                                                                                    
        4 LONI                           SURAT                                                      
12-FEB-99 Lifetime                  2000                50            700                           
                                                                                                    

SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME') GROUP BY MEMBER_ID)
SQL> /

MAX(MAXIMUM)                                                                                        
------------                                                                                        
                                                                                                    

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='lIFETIME') GROUP BY MEMBER_ID
SQL> /

no rows selected

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID
SQL> /

MEMBER_ID   MAXIMUM                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /

MAX(MAXIMUM)                                                                                        
------------                                                                                        
           2                                                                                        

SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime' AND M1.MEMBER_ID = MEMBER.MEMBER_ID) GROUP BY MEMBER_ID))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime' AND M1.MEMBER_ID = MEMBER.MEMBER_ID) GROUP BY MEMBER_ID))
                                                                                                              *
ERROR at line 3:
ORA-00904: "M1"."MEMBER_ID": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime' AND M1.MEMBER_ID = M2.MEMBER_ID) GROUP BY MEMBER_ID))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime' AND M1.MEMBER_ID = M2.MEMBER_ID) GROUP BY MEMBER_ID))
                                                                                                             *
ERROR at line 3:
ORA-00904: "M1"."MEMBER_ID": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)) AND M1.MEMBER_ID = M2.MEMBER_ID
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)) AND M1.MEMBER_ID = M2.MEMBER_ID
                                                                                                                                                  *
ERROR at line 3:
ORA-00904: "M2"."MEMBER_ID": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID))
SQL> /

MEMBER_ID MEMBER_NAME                    MEMBER_ADDRESS                                             
--------- ------------------------------ --------------------------------------------------         
ACC_OPEN_ MEMBERSHIP_TYPE      FEES_PAID MAX_BOOKS_ALLOWED PENALTY_AMOUNT                           
--------- -------------------- --------- ----------------- --------------                           
        1 A                              SURAT                                                      
12-FEB-00 Lifetime                  1000                20            300                           
                                                                                                    
        2 B                              BHUJ                                                       
10-FEB-99 Annual                     300                30            500                           
                                                                                                    
        3 C                              UNJHA                                                      
20-MAR-99 Lifetime                   400                40            800                           
                                                                                                    
        4 LONI                           SURAT                                                      
12-FEB-99 Lifetime                  2000                50            700                           
                                                                                                    

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID))
SQL> /

MEMBER_ID                                                                                           
---------                                                                                           
        1                                                                                           
        2                                                                                           
        3                                                                                           
        4                                                                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID FROM MEMBER M1 
  2  WHERE EXISTS(SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID))
SQL> /

MEMBER_ID                                                                                           
---------                                                                                           
        1                                                                                           
        2                                                                                           
        3                                                                                           
        4                                                                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /

MAX(MAXIMUM)                                                                                        
------------                                                                                        
           2                                                                                        

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /
SELECT MEMBER_ID,MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) GROUP BY MEMBER_ID
SQL> /

MEMBER_ID MAX(MAXIMUM)                                                                              
--------- ------------                                                                              
        1            1                                                                              
        3            2                                                                              

SQL> ED
Wrote file afiedt.buf

  1  SELECT MAX(MAXIMUM) FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID)
SQL> /

MAX(MAXIMUM)                                                                                        
------------                                                                                        
           2                                                                                        

SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID
SQL> /

MEMBER_ID   MAXIMUM                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
                                                                                                         *
ERROR at line 3:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime')))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                                                                                                                                                               *
ERROR at line 2:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime')))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                                                                                                                                                               *
ERROR at line 2:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM ((SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                                                                                                              *
ERROR at line 2:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER WHERE ISSUE.MEMBER_ID = MEMBER.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime')))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                                                                                                                                                               *
ERROR at line 2:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID
SQL> /

MEMBER_ID   MAXIMUM                                                                                 
--------- ---------                                                                                 
        1         1                                                                                 
        3         2                                                                                 

SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime'))
                                                                                                         *
ERROR at line 3:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime')))
SQL> /
WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
                                                                                                                                                                               *
ERROR at line 2:
ORA-00937: not a single-group group function 


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  2  WHERE EXISTS(SELECT * FROM MEMBER M2 WHERE ISSUE.MEMBER_ID = M2.MEMBER_ID AND MEMBERSHIP_TYPE='Lifetime') GROUP BY MEMBER_ID) WHERE MAXIMUM >= ALL(SELECT MAXIMUM FROM (SELECT MEMBER_ID,COUNT(*) AS MAXIMUM FROM ISSUE
  3* WHERE EXISTS(SELECT * FROM ME